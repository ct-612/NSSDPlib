# pre-commit 配置：在提交前自动执行代码质量与样式检查

repos:
  # ---- 基础通用钩子：大文件、冲突标记、行尾和空白修复 ----
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.6.0
    hooks:
      - id: check-added-large-files        # 阻止误提交超大文件
      - id: check-merge-conflict           # 检查是否遗留合并冲突标记
      - id: end-of-file-fixer              # 确保文件以换行结尾
      - id: trailing-whitespace            # 清理行尾多余空白

  # ---- Black：统一代码格式，确保风格一致 ----
  - repo: https://github.com/psf/black
    rev: 24.10.0
    hooks:
      - id: black
        language_version: python3          # 使用环境中的 Python 解释器

  # ---- isort：按照 Black 风格整理 import 顺序 ----
  - repo: https://github.com/pycqa/isort
    rev: 5.13.2
    hooks:
      - id: isort
        args: ["--profile=black"]          # 与 Black 保持风格一致

  # ---- flake8：语法与代码质量检查，可扩展插件 ----
  - repo: https://github.com/PyCQA/flake8
    rev: 7.1.0
    hooks:
      - id: flake8
        additional_dependencies:
          - flake8-bugbear                # 额外规则集，捕获潜在漏洞/坏味道

  # ---- mypy：静态类型检查，限定检查 src 目录 ----
  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.10.0
    hooks:
      - id: mypy
        additional_dependencies:
          - types-requests                # 第三方库的类型标注
        args:
          - --pretty                      # 美化输出
          - src                           # 仅检查源码目录
